<div class="payment-form">
  <h2>Фактура</h2>
  <div class="payment-summary">
    <p>
      Обща цена:
      <strong>
        {{ finalPriceBgn | number:'1.2-2' }} лв.
        / {{ finalPriceEur | number:'1.2-2' }} €
      </strong>
    </p>

    <p *ngIf="discountBgn > 0">
      (Първоначална цена: {{ totalPrice | number:'1.2-2' }} лв.,
      отстъпка от бонус: {{ discountBgn | number:'1.2-2' }} лв.)
    </p>

    <!-- Бонус инфото, което вече имаш -->
    <div *ngIf="loyaltyInfo && loyaltyInfo.loyaltyEnabled">
      <p>
        Бонус точки за <strong>{{ loyaltyInfo.parkingName }}</strong>:
        <strong>{{ loyaltyInfo.points }}</strong>
      </p>

      <p *ngIf="loyaltyInfo.canUseBonus">
        Можеш да използваш бонус за
        <strong>{{ loyaltyInfo.rewardHours }}</strong> ч. безплатен паркинг.
      </p>

      <p *ngIf="!loyaltyInfo.canUseBonus && loyaltyInfo.pointsToNextReward !== null">
        Остават още
        <strong>{{ loyaltyInfo.pointsToNextReward }}</strong> точки до следващ бонус.
      </p>

      <label *ngIf="loyaltyInfo.canUseBonus" class="use-bonus-label">
        <input type="checkbox" [(ngModel)]="useBonus">
        Използвай бонус за тази резервация
      </label>
    </div>
  </div>
  <form [formGroup]="paymentForm" (ngSubmit)="onPaymentSubmit()">
    <div class="card-icons">
      <img src="assets/visa.png" alt="Visa">
      <img src="assets/mastercard.png" alt="MasterCard">
      <img src="assets/jcb.png" alt="JCB">
      <img src="assets/amex.png" alt="American Express">
    </div>
    <div class="form-group">
      <label for="cardNumber">Номер на картата</label>
      <input type="text" id="cardNumber" formControlName="cardNumber" placeholder="1234 5678 9012 3456">
      <div *ngIf="paymentForm.controls['cardNumber'].errors && paymentForm.controls['cardNumber'].touched">
        <small *ngIf="paymentForm.controls['cardNumber'].errors['required']">Номерът на картата е задължителен</small>
        <small *ngIf="paymentForm.controls['cardNumber'].errors['minlength']">Номерът на картата трявбва да е 16 цифрен</small>
        <small *ngIf="paymentForm.controls['cardNumber'].errors['pattern']">Номерът на картата е невалиден</small>
      </div>
    </div>
    <div class="form-group">
      <label for="cardName">Притежател на картата</label>
      <input type="text" id="cardName" formControlName="cardName" placeholder="Ex. John Website">
      <div *ngIf="paymentForm.controls['cardName'].errors && paymentForm.controls['cardName'].touched">
        <small *ngIf="paymentForm.controls['cardName'].errors['required']">Притежателят на картата е задължителен</small>
      </div>
    </div>
    <div class="form-group">
      <label for="expiryDate">Дата на изтичане на картата</label>
      <input type="text" id="expiryDate" formControlName="expiryDate" placeholder="MM/YY">
      <div *ngIf="paymentForm.controls['expiryDate'].errors && paymentForm.controls['expiryDate'].touched">
        <small *ngIf="paymentForm.controls['expiryDate'].errors['required']">Датата на изтичане на картата е задължителна</small>
        <small *ngIf="paymentForm.controls['expiryDate'].errors['pattern']">Датата на изтичане на картата е невалидна</small>
      </div>
    </div>
    <div class="form-group">
      <label for="cvv">CVV2/CVC2 код</label>
      <input type="text" id="cvv" formControlName="cvv" placeholder="123">
      <div *ngIf="paymentForm.controls['cvv'].errors && paymentForm.controls['cvv'].touched">
        <small *ngIf="paymentForm.controls['cvv'].errors['required']">Защитният CVV2/CVC2 код е задължителен</small>
        <small *ngIf="paymentForm.controls['cvv'].errors['minlength']">CVV2/CVC2 кодът трябва да е 3 цифрен</small>
      </div>
    </div>
    <button type="submit" [disabled]="!paymentForm.valid">Next</button>
  </form>
</div>
